# よかった点
> ・ログインしたユーザ属性によって表示するメニューが変わる
> ・ログインユーザやAdminユーザにならないと表示できないページを作成
> ・本の種類のグラフと平均点を自分が表示したい場所へ変更（今までは`<header>`の中で表示していた）
- 授業の内容を吸収できたようでよかったです。そして先週チャートは適切な位置になかったのも直しましたので、ブラッシュアップし続けるのはすごくいいです！コードを見直すことで、さらに良質なものを産出できるようになりますので、是非これからも続けてコードの見直しをしてください！


> （が、なんとなく時間さえあれば全然できそうな気分になっているのは、ここ数か月で自分が成長したからかもしれないなんて思ったりもしています）
- いいですね！あと数週間でプロダクト開発期間に入り、自分でいろんな機能の実装方法を考えないといけないと思いますので、実装をある程度イメージできるのはいいことです。（実際は細かい部分を詰めるのは結構時間がかかると思います。頑張ってください！）

# さらによくするために
- 機能的に完成していない部分がありました。`user_insert`のロジックですが、kanri_flagはデフォルト値が設定されていないので、userを作成できなかったです。SQL文とdatabindingの部分をもう一回確認した方がいいと思います。

- Dbに入っているパスワードはhash化されていますが、`user_insert`の中にそれらしきロジックは見当たらなかったです。

- 管理者権限のフィールドはユーザー登録のformにありますが、`name="accessright"`という命名は気になります。なぜかというと、他のフィールドはユーザーテーブルのカラム名になっていますが、このフィールドだけオリジナルの名前になっています。個人的にはここが`name="kanri_flag"`にした方がいいと思います。もしaccessrightという言葉を使いたいなら、カラム名を直した方が一貫性あります。

> 最初もらったコードの`<? include("menu.php") ?>`の部分が動かずに苦労しました。結局`<?php include("menu.php") ?>`にすることで動くようになったのですが、他の人に聞いても同じ問題に面していないので、もしかするとWindows環境の問題だったのかもしれません・・・
- 環境の問題ではないと思いますが。。文法は環境によって変わることはないです。ライブラリのバージョンによるメソッドやクラスの仕様変更はあり得ますが、今回の文法はライブラリにあるものではないので、違うと思います。単純になぜかMacの人黙って直しただけじゃないでしょうかw

# その他のアドバイス
> あとはログインユーザに対するメニュー変更や、それぞれのページにどのような制限をかけるのかを考えるのに時間を取られ、結局データ編集時に自動的に本のジャンル（カテゴリ）情報をRadioボタンのところにデータベースから持ってくるという機能はつくりこめていません。

経験によるアドバイスですけど、ユーザーが管理フラグがあれば、その他のテーブルも持った方がコードがシンプルになります。例えば下記のようなユーザーテーブルがある

## **user_table**
|id|name|user_id|password|access_control_flag|created_at|
|:---:|:---:|:---:|:---:|:---:|:---:|
|1|'Alice'|'alice0032'|'al&sk3dkdos))'|'administrator'|2020-02-07T12:34:56Z|
|2|'Bob'|'bob20103'|'b8s)#dks%6'|'user'|2020-02-07T01:23:45Z|

## **bookmark_table**
|id|book_title|url|rate|comment|access_control_flag|created_at|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|1|'book1'|'https://www.bookbook.com/data/book1'|4|'Nice Book'|'administrator'|2020-01-02T03:04:05Z|
|2|'book2'|'https://www.bookbook.com/data/book2'|3|'Normal Book'|'user'|2020-01-03T03:04:05Z|
|3|'book3'|'https://www.bookbook.com/data/book3'|2|'Boring Book'|'user'|2020-01-04T03:04:05Z|
|4|'book4'|'https://www.bookbook.com/data/book4'|1|'A@RY&*(23DH'|'user'|2020-01-05T03:04:05Z|

ログインした後、sessionでユーザーIDを持っておけば、下記のようにデータが一発取れる

```sql
SELECT * 
FROM bookmar_table
WHERE access_control_flag = (
  SELECT access_control_flag
  FROM user_table
  WHERE user_id = RECENT_USER_ID
);
```
もしくはJOINとかを使っても大丈夫です。基本テーブル設計をする段階で、アプリケーションの機能をどのように簡単に実装できるかを考えた方がいいです。

